# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç 6: "–°–ø–µ—Ü–Ω–∞–∑" (Stealth / Anti-Bot Bypass)

**–°—Ç–µ–∫:** `DrissionPage` (Sync).
**–°—É—Ç—å:** –≠—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ "–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–Ω—Å–∞". –û–Ω–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WebDriver (–∫–∞–∫ Selenium), –∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä–æ–º –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ **Chrome DevTools Protocol (CDP)**.
**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ:**

1. –£ –Ω–µ—ë –Ω–µ—Ç —Ñ–ª–∞–≥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (`navigator.webdriver` —á–∏—Å—Ç—ã–π).
2. –û–Ω–∞ —É–º–µ–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –º—ã—à—å—é –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–∫–ª–∏–∫–∏ –≤—ã–≥–ª—è–¥—è—Ç 100% –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ).
3. –û–Ω–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç Cloudflare Turnstile (–≥–∞–ª–æ—á–∫—É) —á–∞—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ñ–∞–∫—Ç–æ–º —Å–≤–æ–µ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è.

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å:** –ö–æ–≥–¥–∞ Playwright –ª–æ–≤–∏—Ç –±–∞–Ω, –∫–æ–≥–¥–∞ –≤–∏–¥–∏—à—å "Checking your browser...", –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–∫–ª–∏–∫–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –∫–∞–ø—á—É.

**–í–Ω–∏–º–∞–Ω–∏–µ:** –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è (–ø–æ—Ç–æ–º—É —á—Ç–æ –∏–º–∏—Ç–∞—Ü–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –Ω–µ —Ç–µ—Ä–ø–∏—Ç —Å–ø–µ—à–∫–∏).

```python
from DrissionPage import ChromiumPage, ChromiumOptions
import time
import random

# --- 1. CONFIG ---
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ "–ü—Ä–æ—Ñ–∏–ª—è". DrissionPage –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å Chrome,
# —Ç–æ–≥–¥–∞ —Ç—ã –±—É–¥–µ—à—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω –≤–µ–∑–¥–µ. –ù–æ —Ç—É—Ç —Å–¥–µ–ª–∞–µ–º —á–∏—Å—Ç—ã–π –∏–Ω—Å—Ç–∞–Ω—Å.
def get_options():
    co = ChromiumOptions()
    # co.headless(True) # –í–∫–ª—é—á–∏, –µ—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—à—å –≤–∏–¥–µ—Ç—å –±—Ä–∞—É–∑–µ—Ä (–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ª—É—á—à–µ False)
    co.set_argument('--no-first-run')
    # –ú–æ–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ–∫—Å–∏
    # co.set_proxy('<http://user:pass@ip>:port')
    return co

# --- 2. PARSER CLASS ---
class StealthWorker:
    def __init__(self):
        # –ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä
        self.page = ChromiumPage(get_options())

    def bypass_protection(self, url: str):
        print(f"ü•∑ –°–ø–µ—Ü–Ω–∞–∑ –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞: {url}")
        self.page.get(url)

        # --- –≠–¢–ê–ü 1: –ü—Ä–æ—Ö–æ–¥ –∑–∞—â–∏—Ç—ã (Cloudflare / Turnstile) ---
        # DrissionPage —á–∞—Å—Ç–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç Cloudflare —Å–∞–º, –ø—Ä–æ—Å—Ç–æ –æ–∂–∏–¥–∞—è.
        # –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫–Ω–æ–ø–∫–∞ "Verify you are human":

        if self.page.ele('text:Verify you are human', timeout=2):
            print("‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ Cloudflare...")
            time.sleep(random.uniform(2, 4))

            # –ò—â–µ–º —á–µ–∫–±–æ–∫—Å (Shadow Root –ø—Ä–æ–±–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
            # –≠—Ç–æ –∫–∏–ª–ª–µ—Ä-—Ñ–∏—á–∞: –Ω–µ –Ω–∞–¥–æ –ø–∏—Å–∞—Ç—å —Å–ª–æ–∂–Ω—ã–π JS –¥–ª—è shadow-dom
            checkbox = self.page.ele('@type=checkbox')
            if checkbox:
                print("‚ö° –ö–ª–∏–∫–∞–µ–º –≥–∞–ª–æ—á–∫—É...")
                checkbox.click() # –ö–ª–∏–∫ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π
                time.sleep(5) # –ñ–¥–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

        # –ñ–¥–µ–º, –ø–æ–∫–∞ –∏—Å—á–µ–∑–Ω–µ—Ç –ª–æ–∞–¥–µ—Ä –∏–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç
        # self.page.wait.ele_display('#product-list')

    def parse_data(self):
        # --- –≠–¢–ê–ü 2: –ü–∞—Ä—Å–∏–Ω–≥ ---
        title = self.page.title
        print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞—à–ª–∏. –ó–∞–≥–æ–ª–æ–≤–æ–∫: {title}")

        # –°–∏–Ω—Ç–∞–∫—Å–∏—Å DrissionPage —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π, –Ω–æ –º–æ—â–Ω—ã–π
        # .eles() = –Ω–∞–π—Ç–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        products = self.page.eles('.product-card')

        print(f"üì¶ –ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {len(products)}")
        for p in products:
            # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞
            name = p.ele('.name').text
            price = p.ele('.price').text
            print(f"   - {name} | {price}")

    def switch_to_fast_mode(self):
        """
        –†–ï–ñ–ò–ú –ë–û–ì–ê: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ requests.
        –ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫–∞–ø—á–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –±–µ–∑ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞,
        —á—Ç–æ–±—ã –ø–∞—Ä—Å–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –∫—É–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞.
        """
        print("üöÄ –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –≤ —Ä–µ–∂–∏–º s_mode (—Ç–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å—ã)...")
        self.page.change_mode() # –¢–µ–ø–µ—Ä—å self.page —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Session, –∞ –Ω–µ –∫–∞–∫ –ë—Ä–∞—É–∑–µ—Ä

        # –¢–µ–ø–µ—Ä—å —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ (–∫–∞–∫ requests)
        resp = self.page.get("<https://site.com/api/products>")
        print("–û—Ç–≤–µ—Ç API:", resp.text[:100])

    def close(self):
        self.page.quit()

# --- 3. ENTRY ---
def main():
    worker = StealthWorker()
    try:
        # –¢–µ—Å—Ç –Ω–∞ —Å–∞–π—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–æ—Ç–æ–≤
        worker.bypass_protection("<https://nowsecure.nl>")

        # worker.parse_data()
        # worker.switch_to_fast_mode()

    finally:
        worker.close()

if __name__ == "__main__":
    main()

```

**–ö—É–¥–∞ —Å–º–æ—Ç—Ä–µ—Ç—å:**

1. **`page.change_mode()`**: –≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è —Ñ–∏—à–∫–∞. –¢—ã –ø—Ä–æ—Ö–æ–¥–∏—à—å –∫–∞–ø—á—É –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä, –∞ –ø–æ—Ç–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—à—å—Å—è –≤ —Ä–µ–∂–∏–º "–∑–∞–ø—Ä–æ—Å–æ–≤" –∏ –ø–∞—Ä—Å–∏—à—å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–∞–π—Ç –±—ã—Å—Ç—Ä–æ, –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∫—É–∫–∏.
2. **`page.ele('@type=checkbox')`**: –°–∏–Ω—Ç–∞–∫—Å–∏—Å `@` –∏—â–µ—Ç –ø–æ –∞—Ç—Ä–∏–±—É—Ç–∞–º. DrissionPage —Å–∞–º –ø—Ä–æ–±–∏–≤–∞–µ—Ç Shadow DOM (—Ç–µ–Ω–µ–≤–æ–π DOM), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–∞–ø—á–∏. –í Selenium/Playwright –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–Ω–∏ –∫–æ–¥–∞.
3. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π `asyncio` –∏ `await` —Å —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π. –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–ª–æ–∫–∏—Ä—É—é—â–µ–º —Ä–µ–∂–∏–º–µ.